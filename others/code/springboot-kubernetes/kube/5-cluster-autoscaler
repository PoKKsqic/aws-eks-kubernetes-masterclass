#CA autoScaling（Change YOUR CLUSTER NAME）
curl -o cluster-autoscaler-autodiscover.yaml https://raw.githubusercontent.com/kubernetes/autoscaler/master/cluster-autoscaler/cloudprovider/aws/examples/cluster-autoscaler-autodiscover.yaml


            - --node-group-auto-discovery=asg:tag=k8s.io/cluster-autoscaler/enabled,k8s.io/cluster-autoscaler/<YOUR CLUSTER NAME>
            - --balance-similar-node-groups
            - --skip-nodes-with-system-pods=false
            - --aws-use-static-instance-list=true


kubectl apply -f cluster-autoscaler-autodiscover.yaml
kubectl patch deployment cluster-autoscaler   -n kube-system   -p '{"spec":{"template":{"metadata":{"annotations":{"cluster-autoscaler.kubernetes.io/safe-to-evict": "false"}}}}}'





# update image
kubectl set image deployment.apps/cluster-autoscaler-deployment cluster-autoscaler=k8s.gcr.io/autoscaling/cluster-autoscaler:v<1.21.n> --record=true -n kube-system


kubectl rollout status deployment.apps/cluster-autoscaler-deployment -n kube-system

kubectl rollout history deployment.apps/cluster-autoscaler-deployment -n kube-system

kubectl rollout undo deployment.apps/cluster-autoscaler-deployment -n kube-system
